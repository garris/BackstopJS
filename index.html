<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Encode+Sans:300,200" rel="stylesheet">

    <link rel="stylesheet" href="./assets/styles.css">
  </head>
  <body>
  	<div class="page-root container-fluid">
      <div class="row justify-content-center moneyshot">
        <div class="col-10">
          <p class="mascotBlock">
            <a href="https://github.com/garris/BackstopJS" class="lemur-link">
              <img id="theLemur" src="assets/lemurFace.png" class='lemurInYourFace' alt="">
            </a>
            <img id="lemurButt" src="assets/lemurButt.png" class='lemurButtInYourFace' alt="">
          </p>
          <p class="logoBlock">
            <a href="https://github.com/garris/BackstopJS" class="logo-link">
              <img src="assets/BackstopJS.svg" class='BackstopJS3' alt="BackstopJS">
            </a>
          </p>
        </div>
        <h1>Visual regression testing for web apps.</h1>
      </div>
      <div class="row justify-content-center">
        <p class="supportsBlock col-10">
          Supports screen rendering with <a href="https://chromium.googlesource.com/chromium/src/+/lkgr/headless/README.md" class="chrome">Chrome-headless.</a>
          Add your own interactions with <a href="https://playwright.dev/" class="chrome">Playwright</a> and <a href="https://github.com/GoogleChrome/puppeteer" class="chrome">Puppeteer</a> scripting.
        </p>
      </div>
      <div class="row justify-content-center">
        <p class="getItBlock col-10">
          BackstopJS was created by <a href="https://www.linkedin.com/in/garrisshipon/">Garris Shipon</a> with contributions from <a href="https://github.com/garris/BackstopJS#credits">these amazing engineers</a>.
        </p>
        <p class="getItBlock col-10">
          Opensourced under the <a href="https://raw.githubusercontent.com/garris/BackstopJS/master/LICENSE">The MIT License</a>.
        </p>
        <p class="getItBlock col-10">
          <span class="cta"><a href="https://github.com/garris/BackstopJS" class="github-link"><img src="assets/github-icon.png" class="github-icon" alt="Get it on GitHub"></a></span>
          <span class="cta"><a href="https://github.com/garris/BackstopJS">Get it on github!</a></span>
        </p>
        <p class="getItBlock cantSeeDis col-10" style="display: none;">
          <img src="assets/github-icon.png" class="github-icon" alt="Get it on GitHub">
        </p>
      </div>
    </div>
    <p id="noShow" style="display: none;">This is text that should not show.</p>
    
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
  </body>
</html>

<script type="text/javascript">
  const READY_LAG_MS = 3000;
  const READY_TAG = '_the_lemur_is_ready_to_see_you';
  const OCTOCAT_CLASS_ACTION = 'hideOctocat';
  const LEMUR_CLASS_ACTION = 'hideLemur';
  const COOKIE_TEST = /cookie/i;
  const CLICK_TEST = /click/i;
  const DELAY_TEST = /delay/i;

  if (COOKIE_TEST.test(window.location.search)) {
    showCookies();
  }
  if (CLICK_TEST.test(window.location.search)) {
    modifyLemurBehavior();
  }
  if (DELAY_TEST.test(window.location.search)) {
    delayLemurification();
  }

  function modifyLemurBehavior () {
    document.body.addEventListener('click', evt => {
      if (evt.target.id === 'theLemur') {
        containTheLemur();
        evt.preventDefault();
        setTimeout(setReadyFlags, READY_LAG_MS + 1000);
      } else {
        releaseTheLemur();
      }
    });
    console.log('lemur behavior is modified');
  }

  function showCookies () {
    document.getElementsByClassName('logoBlock')[0].innerText = 'cookies > ' + document.cookie;
  }

  function setReadyFlags () {
    console.log(READY_TAG);
    document.body.classList.add(READY_TAG);
  }

  function releaseTheLemur () {
    document.body.classList.remove(LEMUR_CLASS_ACTION);
  }

  function containTheLemur () {
    document.body.classList.add(LEMUR_CLASS_ACTION);
  }

  function hideOctocat () {
    console.log('hideOctocat')
    document.body.classList.add(OCTOCAT_CLASS_ACTION);
  }

  function showOctocat () {
    document.body.classList.remove(OCTOCAT_CLASS_ACTION);
  }

  function delayLemurification () {
    containTheLemur();
    hideOctocat();
    setTimeout(releaseTheLemur, READY_LAG_MS);
    setTimeout(showOctocat, READY_LAG_MS);
    setTimeout(setReadyFlags, READY_LAG_MS + 1000);
  }
</script>
